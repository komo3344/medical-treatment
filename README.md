## 프로젝트 세팅 방법
로컬 컴퓨터에 5432포트와 8000포트에서 실행되고 있는 프로그램이 없다고 가정합니다.   
(있을 경우 포트 충돌이 일어나기 때문에 해당 프로그램은 종료시킨 후 테스트 해야 합니다.)
1. `docker-compose up` 도커가 설치된 환경의 프로젝트 루트 경로에서 해당 명령어를 실행합니다.
2. `docker-compose run app python manage.py init_data` 초기데이터를 세팅합니다.

## 데이터 입력 방법 (관리자 페이지 접속)
- `docker-compose run app python manage.py createsuperuser` 
  - 사용자 이름, 이메일(생략가능), 패스워드를 순차적으로 입력하여 관리자 계정을 생성합니다.
- http://0.0.0.0:8000/admin 접속 후 이름과 패스워드를 입력하고 접속합니다.
- 각 데이터들을 추가하고 수정하여 테스트 할 수 있습니다.

## API 실행 방법

아래 세가지 방법 중 하나로 실행시킬 수 있습니다.

1. ### 브라우저에서 API URL을 통해 호출하는 방법
    - 브라우저창에 api 주소를 입력합니다. (GET API 경우에는 바로 호출됩니다.)
    - POST 요청의 경우에는 Media Type을 "application/json"으로 하고 content에 json 형식의 데이터를 넣어 테스트 할 수 있습니다.
2. ### POSTMAN 툴을 통해 호출하는 방법
   - URL에 API 주소 기입
   - BODY(raw - JSON) 으로 설정 뒤 데이터를 넣어 호출합니다.
3. ### Swagger를 통해 API를 호출하는 방법
    http://0.0.0.0:8000/docs 주소로 들어갑니다.

    1. **Try it out** 버튼을 클릭 후 
    2. 필요한 데이터를 채워 넣은 후 **Execute** 버튼을 통해 API를 호출할 수 있습니다.
    

## 각 로직 API 실행 방법
1. ### 의사 검색
   - 문자열 검색
      - **GET api/doctors?query=<검색할 문자열 입력>**
      - 띄어쓰기 단위로 단어들이 토큰화됩니다. 토큰화된 단어들이 의사이름, 병원이름, 진료과에 포함되면 필터링됩니다.
      - 의사 이름이 들어가는 경우 일치하지 않는 과, 병원이름이 있을 경우 필터되지 않습니다.
      - (조금 더 고도화된 검색을 위해선 elasticsearch가 필요하지만 해당 부분은 구현되지 않았습니다.)
   - 특정 날짜와 시간 입력하여 영업중인 의사 반환
     - **GET api/doctors?datetime=<"날짜 및 시간 입력">**
     - e.g. api/doctors?datetime=2023-12-15 10:00
     - **(%Y-%m-%d %H:%M 형식의 문자열이며 띄어쓰기로 날짜와 시간을 구분합니다.)**
2. ### 진료 요청
   - **POST api/treatments/request**
   - request body: 
     - doctor_id: 의사 id
     - patient_id: 환자 id
     - desired_date: 2023-12-15 10:30 **(희망시간은 %Y-%m-%d %H:%M 형식의 문자열입니다.)**
   - 해당 API 요청 시 각 케이스마다 만료시간이 설정됩니다.
     - 의사의 점심시간에 요청이 들어온 경우 점심시간이 끝나는 시간 + 15분으로 만료시간이 저장됩니다.
     - 의사의 휴무일에 요청이 들어온 경우 다음 영업일 시작시간 + 15분으로 만료시간이 저장됩니다.
     - 이외에는 요청이 들어온 시간 + 20분으로 만료시간이 저장됩니다.
3. ### 진료 요청 검색
   - **GET api/doctors/<int:pk>/treatment-request**
   - 수락된 요청은 제외됩니다.
   - 수락되지 않았지만 만료시간이 지난 요청들도 리스트에 표시됩니다. (제외하는 로직을 추가하지 않았습니다.)
4. ### 진료 요청 수락
   - **POST api/treatments/<int:pk>/accept**
   - 요청할 BODY는 없으며 만료시간이 지난 경우 validation error와 메시지가 함께 반환됩니다.
